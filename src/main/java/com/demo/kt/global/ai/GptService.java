package com.demo.kt.global.ai;

import org.springframework.stereotype.Service;

@Service
public class GptService {

    public String generatePrompt(String data) {
        // Diary diary = diaryRepository.findById(memberId) 와 같은 형태로 관찰일지를 불러와 데이터 활용 가능
        String diary = "까미, 5개월, 수컷, 포메라니안\n2025년3월14일, 오늘은 까미가 오른쪽 다리를"
                + "절뚝거렸다. 병원에 가보니 높은 곳에서 떨어진 충격 때문에 인대에 손상이 생긴 것 같다고 하셨다."
                + "강아지가 올라오기에는 침대 높이가 너무 높았던 것 같다... 얼렁 까미 전용 계단 만들어줘야지ㅜ";

        StringBuilder prompt = new StringBuilder();

        prompt.append("나는 강아지를 키우는 반려인이야. 강아지 이름, 나이, 성별, 품종과 같은 강아지에 대한 기본적인 정보와 함께"
                + "날짜, 관찰 내용이 적혀있는 날짜별 강아지 관찰 일지들을 제공할거야.\n"
                + "너는 수의사의 비서로서 강아지와 관련된 정보를 병원에서 치료해야하는 내용 위주로 체계적으로 요약해서 전달함으로써 강아지 진료에 도움을 줄 수 있어야해.\n"
                + "관찰일지는 몇십개가 제공될 수도 있어. 제공되는 모든 관찰일지에 대해 날짜별로 요약하지 말고, 해당 강아지의 건강에 대해 "
                + "알아야 할 특이사항에 대해서만 종합적인 소견을 작성해줘. 그리고 추가적으로 오늘 병원 방문 이유에 대해 예상되는 원인이 있으면 따로 정리해줘.\n"
                + "전체 내용이 공백 포함 2000자 이내로 작성되어야 하니까 중요도에 따라, 중요한 것들 위주로 개조식으로 요약해줘.\n\n");

        prompt.append(diary);
        prompt.append("2025년 3월 15일,"
                + "오늘은 까미가 아침에 사료를 잘 안 먹었다. 원래 식탐이 많은데 갑자기 입맛이 없어진 것 같아서 걱정됐다. 간식을 주니까 간식은 잘 먹어서 다행이긴 한데… 혹시나 해서 하루 동안 상태를 지켜보기로 했다.");
        prompt.append("2025년 3월 16일,"
                + "까미가 오늘은 다시 잘 먹기 시작했다! 어제는 그냥 컨디션이 안 좋았던 걸까? 그래도 혹시 모르니 사료를 바꿔봐야 하나 고민 중이다.");
        prompt.append("2025년 3월 17일,"
                + "산책을 나갔는데 까미가 갑자기 잔디밭에 배를 대고 움직이지 않았다. 혹시 어디 아픈 건가 했는데, 알고 보니 땅이 시원해서 그런 거였다. 깜짝 놀랐네...");
        prompt.append("2025년 3월 18일,"
                + "오늘은 까미가 집에서 계속 긁었다. 피부에 문제가 생긴 건 아닐까 싶어서 털을 살펴보니, 겨드랑이 쪽에 살짝 붉은기가 있었다. 혹시 알레르기일까? 내일 병원에 가봐야겠다.");
        prompt.append("2025년 3월 19일,"
                + "까미가 아침부터 에너지가 넘쳤다. 장난감을 물고 와서 같이 놀아달라고 졸랐다. 한참 놀아주고 나니까 지쳤는지 스스로 집에 가서 쿨쿨 잤다.");
        prompt.append("2025년 3월 20일,"
                + "산책을 나갔는데 바람이 많이 불어서 그런지 까미가 귀를 뒤로 젖히고 신기한 듯 주변을 둘러봤다. 길에서 만난 다른 강아지랑 인사도 잘하고, 꼬리를 살랑살랑 흔들어서 다행이다.");
        prompt.append("2025년 3월 21일,"
                + "오늘은 평소보다 더 활발했다. 공을 던져주면 몇 번이나 달려가서 물고 오고, 스스로도 장난감을 던졌다가 쫓아가길 반복했다. 점점 놀이 방법을 터득하는 것 같아서 뿌듯하다.");
        prompt.append("\n\n그리고 아래는 오늘 병원을 방문한 이유야.\n");
        prompt.append(data);

        return prompt.toString();
    }

}
